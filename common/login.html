<form id="loginfrm" class="margin-bottom-40">
<h2>{$login}</h2>
    <div class="form-group">
        <label class="sr-only" for="username">{$username}</label>
        <input type="text" class="form-control" id="username" name="username" placeholder="{$username} | ID | {$email}" required>
    </div>
    <div class="form-group">
        <label class="sr-only" for="username">{$password}</label>
        <input type="password" class="form-control" name="password" placeholder="{$password}" required>
        <input type="hidden" value="{$tok_n}" name="tok"/>
    </div>
    <div class="form-check">
        <label for="remember" class="form-check-label">
            <input type="checkbox" name="setcookie" id="remember" class="form-check-input" checked>
            {$remember_me}
        </label>
        <label for="markoffline" class="form-check-label">
            <input type="checkbox" name="offline" id="markoffline" class="form-check-input">
            {$hide_status}
        </label>
    </div>
    <div class="form-group">
    <button type="submit" class="btn login">{$login}</button>
    <a href="/reset.php" class="btn reset" >{$reset_password}</a>
    </div>
</form>
<div id="loginmsgbox" class="alert alert-info" role="alert" style="display: none;"></div>
<script>
    $("#loginfrm").on('submit', function (event) {
        var $me = $(this), t = $("#loginmsgbox");
        t.html(N.getLangData().LOADING);
        event.preventDefault();
        N.json.login($me.serialize() +'&query_string={if="isset($querystring_n)"}{$querystring_n}{/if}', function (r) {
            t.html(r.message);
            t.css("display", "block");
            if (r.status == 'ok') {
                setTimeout(function () {
                    if(typeof r.redirect === 'undefined') {
                        document.location.reload();
                    } else {
                        document.location.href = r.redirect + window.location.search;
                    }
                }, 1500);
            }
            else {
                setTimeout(function () {
                    t.html('');
                    t.css("display","none")
                    $me.show();
                }, 1500);
            }
        });
    });
</script>
